{"version":3,"file":"_server.ts-9cc60e2f.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/config/_server.ts.js"],"sourcesContent":["import fs from \"fs\";\nimport shell from \"shelljs\";\nimport path from \"path\";\nimport { r as run } from \"../../../../chunks/run.js\";\nconst GET = async () => {\n  const configPath = path.resolve(`.`, \"config.json\");\n  const data = JSON.parse(fs.readFileSync(configPath, { encoding: \"utf8\" }) || \"[]\");\n  return new Response(\n    JSON.stringify(data),\n    {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }\n  );\n};\nconst POST = async ({ request }) => {\n  const { domain, port } = await request.json();\n  const data = JSON.parse(fs.readFileSync(`./config.json`, { encoding: \"utf8\" }) || \"[]\");\n  const exists = data.find((d) => d.localDomainName === domain);\n  if (exists) {\n    return new Response(\n      JSON.stringify({}),\n      {\n        status: 409,\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }\n    );\n  }\n  shell.exec(`mkcert -install \t-key-file ssl/${domain}-key.pem \t-cert-file ssl/${domain}-cert.pem \t${domain} localhost 127.0.0.1 ::1 > /dev/null`);\n  const newData = [...data, {\n    localDomainName: domain,\n    port,\n    ssl: { cert: `./ssl/${domain}-cert.pem`, key: `./ssl/${domain}-key.pem` },\n    nginxConf: null\n  }];\n  fs.writeFileSync(\"./config.json\", JSON.stringify(newData, null, 2));\n  run();\n  return new Response(\n    JSON.stringify({}),\n    {\n      status: 200,\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }\n  );\n};\nexport {\n  GET,\n  POST\n};\n"],"names":[],"mappings":";;;;;;AAIK,MAAC,GAAG,GAAG,YAAY;AACxB,EAAE,MAAM,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,aAAa,CAAC,CAAC;AACtD,EAAE,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,UAAU,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC;AACrF,EAAE,OAAO,IAAI,QAAQ;AACrB,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;AACxB,IAAI;AACJ,MAAM,MAAM,EAAE,GAAG;AACjB,MAAM,OAAO,EAAE;AACf,QAAQ,cAAc,EAAE,kBAAkB;AAC1C,OAAO;AACP,KAAK;AACL,GAAG,CAAC;AACJ,EAAE;AACG,MAAC,IAAI,GAAG,OAAO,EAAE,OAAO,EAAE,KAAK;AACpC,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;AAChD,EAAE,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC,aAAa,CAAC,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC;AAC1F,EAAE,MAAM,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,eAAe,KAAK,MAAM,CAAC,CAAC;AAChE,EAAE,IAAI,MAAM,EAAE;AACd,IAAI,OAAO,IAAI,QAAQ;AACvB,MAAM,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC;AACxB,MAAM;AACN,QAAQ,MAAM,EAAE,GAAG;AACnB,QAAQ,OAAO,EAAE;AACjB,UAAU,cAAc,EAAE,kBAAkB;AAC5C,SAAS;AACT,OAAO;AACP,KAAK,CAAC;AACN,GAAG;AACH,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,+BAA+B,EAAE,MAAM,CAAC,yBAAyB,EAAE,MAAM,CAAC,WAAW,EAAE,MAAM,CAAC,oCAAoC,CAAC,CAAC,CAAC;AACnJ,EAAE,MAAM,OAAO,GAAG,CAAC,GAAG,IAAI,EAAE;AAC5B,IAAI,eAAe,EAAE,MAAM;AAC3B,IAAI,IAAI;AACR,IAAI,GAAG,EAAE,EAAE,IAAI,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,MAAM,CAAC,QAAQ,CAAC,EAAE;AAC7E,IAAI,SAAS,EAAE,IAAI;AACnB,GAAG,CAAC,CAAC;AACL,EAAE,EAAE,CAAC,aAAa,CAAC,eAAe,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;AACtE,EAAE,GAAG,EAAE,CAAC;AACR,EAAE,OAAO,IAAI,QAAQ;AACrB,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC;AACtB,IAAI;AACJ,MAAM,MAAM,EAAE,GAAG;AACjB,MAAM,OAAO,EAAE;AACf,QAAQ,cAAc,EAAE,kBAAkB;AAC1C,OAAO;AACP,KAAK;AACL,GAAG,CAAC;AACJ;;;;"}